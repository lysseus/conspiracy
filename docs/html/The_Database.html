<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2&nbsp;The Database</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Conspiracy Library</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Getting_Started.html" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="The_Database.html" class="tocviewselflink" data-pltdoc="x">The Database</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Messaging_Objects.html" class="tocviewlink" data-pltdoc="x">Messaging Objects</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Registering_Objects.html" class="tocviewlink" data-pltdoc="x">Registering Objects</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Special_Properties.html" class="tocviewlink" data-pltdoc="x">Special Properties</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="Special_Property_Values.html" class="tocviewlink" data-pltdoc="x">Special Property Values</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="Pseudo-Variables.html" class="tocviewlink" data-pltdoc="x">Pseudo-<wbr></wbr>Variables</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="Inheritance.html" class="tocviewlink" data-pltdoc="x">Inheritance</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="Templates.html" class="tocviewlink" data-pltdoc="x">Templates</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="Object.html" class="tocviewlink" data-pltdoc="x">Object</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="Characteristics_Object.html" class="tocviewlink" data-pltdoc="x">Characteristics Object</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="Nothing_Object.html" class="tocviewlink" data-pltdoc="x">Nothing Object</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="Rule_Object.html" class="tocviewlink" data-pltdoc="x">Rule Object</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>2&nbsp;</td><td><a href="The_Database.html" class="tocviewselflink" data-pltdoc="x">The Database</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="The_Database.html#%28part._object-names%29" class="tocviewlink" data-pltdoc="x"><span class="stt">object-<wbr></wbr>names</span></a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="The_Database.html#%28part._objects%29" class="tocviewlink" data-pltdoc="x"><span class="stt">objects</span></a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="The_Database.html#%28part._.Filtering%29" class="tocviewlink" data-pltdoc="x">Filtering</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._object-names%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">object-<wbr></wbr>names</span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._objects%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">objects</span></a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Filtering%29" class="tocsubseclink" data-pltdoc="x">Filtering</a></td></tr><tr><td><span class="tocsublinknumber">2.3.1<tt>&nbsp;</tt></span><a href="#%28part._with-objects%29" class="tocsubseclink" data-pltdoc="x">with-<wbr></wbr>objects</a></td></tr><tr><td><span class="tocsublinknumber">2.3.2<tt>&nbsp;</tt></span><a href="#%28part._without-objects%29" class="tocsubseclink" data-pltdoc="x">without-<wbr></wbr>objects</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.4</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Getting_Started.html" title="backward to &quot;1 Getting Started&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Conspiracy Library&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Messaging_Objects.html" title="forward to &quot;3 Messaging Objects&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>2<tt>&nbsp;</tt><a name="(part._.The_.Database)"></a>The Database</h3><p>Although its been said that objects can be represented as nothing more than structs with associated functions, Conspiracy takes a somewhat different approach of defining them as keys in a hash table whose values are hash tables of property keys and their values.</p><p>As mentioned in the previous section on the quoting of unbound symbols, object and property names needn&rsquo;t have meaning outside the objects database.</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">&gt; Object</span></p></td></tr><tr><td><p><span class="stt">'Object</span></p></td></tr></table></p><p>On the other hand, it&rsquo;s perfectly possible to define an object named &rsquo;pi&rsquo; or &rsquo;&#955;&rsquo; in the objects database with meanings independent of their normal Racket bound values. In those cases, however, it will be important to remember to quote the symbol names to avoid operating on their bound values, rather than on their symbols.</p><p>But the practical upshot of this is that neither objects, nor properties, are first class values. You can&rsquo;t pass an object into a function, because it doesn&rsquo;t live outside of the database.</p><h4>2.1<tt>&nbsp;</tt><a name="(part._object-names)"></a><span class="stt">object-names</span></h4><p>At any point the object names registered in the objects database can be retrieved with the object-names macro like this:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(Object)</span></p></td></tr></table></p><p>Although it&rsquo;s a list of object names, the list is constructed in arbitrary order and doesn&rsquo;t represent a historic perspective of object definition.</p><h4>2.2<tt>&nbsp;</tt><a name="(part._objects)"></a><span class="stt">objects</span></h4><p>The <span class="stt">objects</span> macro provides a &rsquo;raw&rsquo; view of the objects database. By using it, you can glimpse &rsquo;under the hood&rsquo; or &rsquo;behind the curtain&rsquo; at the hash tables that comprise it.</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">&gt; objects</span></p></td></tr><tr><td><p><span class="stt">'#hasheq((Object</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">.</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#hasheq((assert . #&lt;procedure:...nspiracy/object.rkt:270:42&gt;)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(assert! . #&lt;procedure:...nspiracy/object.rkt:270:42&gt;)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(set-method! . #&lt;procedure:[...nspiracy/object.rkt:270:42&gt;)</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(show . #&lt;procedure:...onspiracy/object.rkt:270:42&gt;))))</span></p></td></tr></table></p><p>We&rsquo;ve abbreviated the properties listing for Object. But you can clearly see the key/value pairs of the hash tables involved, both of which use symbols for keys.</p><p>So far we only have <span class="stt">Object</span> registered in the database. But before we move on to defining, we need to discuss messaging in the <span style="font-style: italic">messaging</span> section.</p><h4>2.3<tt>&nbsp;</tt><a name="(part._.Filtering)"></a>Filtering</h4><p>As stated earlier, database object and property symbols are not bound by the library. This means you have to pass the database and its macro and function operators to modules that want to make use of Conspiracy objects.</p><p>Sometimes you might want a subset of the database instead. Conspiracy provides 2 forms that parameterize the database allowing you to filter it at the same time.</p><p><div class="SIntrapara">The following macros parameterize on:
</div><div class="SIntrapara"><ul><li><p>objects</p></li><li><p>default-kind</p></li><li><p>debug</p></li></ul></div></p><p>Parameterizing these values means that within the context of the <span class="stt">with-objects</span> and <span class="stt">without-objects</span> macro bodies those values can be modified, but will be restored to their original values once control returns outside of the macros.</p><h5>2.3.1<tt>&nbsp;</tt><a name="(part._with-objects)"></a>with-objects</h5><p>Filter objects by kinds and their <span style="font-style: italic">inherited</span> objects.</p><p><span style="font-weight: bold">Syntax:</span></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(</span><span style="font-weight: bold">with-objects</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(</span><span style="font-style: italic">kind</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">...) body ...)</span></p></td></tr></table></p><p><span style="font-weight: bold">Examples:</span></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; (with-objects () (% A) (% B) object-names)</span></p></td></tr><tr><td><p><span class="stt">'(B A Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; (% A)</span></p></td></tr><tr><td><p><span class="stt">'A</span></p></td></tr><tr><td><p><span class="stt">&gt; (% B)</span></p></td></tr><tr><td><p><span class="stt">'B</span></p></td></tr><tr><td><p><span class="stt">&gt; (% C (kinds A B))</span></p></td></tr><tr><td><p><span class="stt">'C</span></p></td></tr><tr><td><p><span class="stt">&gt; (with-objects (A) object-names)</span></p></td></tr><tr><td><p><span class="stt">'(A Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; (% D (kinds C))</span></p></td></tr><tr><td><p><span class="stt">'D</span></p></td></tr><tr><td><p><span class="stt">&gt; (with-objects (C) object-names)</span></p></td></tr><tr><td><p><span class="stt">'(C B A Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(C B D A Object)</span></p></td></tr></table></p><h5>2.3.2<tt>&nbsp;</tt><a name="(part._without-objects)"></a>without-objects</h5><p>Filter-not objects by kinds and their <span style="font-style: italic">modified</span> and <span style="font-style: italic">inheriting</span> objects.</p><p><span style="font-weight: bold">Syntax:</span></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">(</span><span style="font-weight: bold">without-objects</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">(</span><span style="font-style: italic">kind</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">...) body ...)</span></p></td></tr></table></p><p><span style="font-weight: bold">Examples:</span></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; (% A)</span></p></td></tr><tr><td><p><span class="stt">'A</span></p></td></tr><tr><td><p><span class="stt">&gt; (%+ A (p0 14))</span></p></td></tr><tr><td><p><span class="stt">'A</span></p></td></tr><tr><td><p><span class="stt">&gt; (% B)</span></p></td></tr><tr><td><p><span class="stt">'B</span></p></td></tr><tr><td><p><span class="stt">&gt; (% C (kinds A))</span></p></td></tr><tr><td><p><span class="stt">'C</span></p></td></tr><tr><td><p><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(B mod#5944484 C A Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; (without-objects (A) object-names)</span></p></td></tr><tr><td><p><span class="stt">'(B Object)</span></p></td></tr><tr><td><p><span class="stt">&gt; object-names</span></p></td></tr><tr><td><p><span class="stt">'(B mod#5944484 C A Object)</span></p></td></tr></table></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Getting_Started.html" title="backward to &quot;1 Getting Started&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Conspiracy Library&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Messaging_Objects.html" title="forward to &quot;3 Messaging Objects&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>